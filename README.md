# Manual Setup of Audio Transcription and Summary Workflow (AWS Console)

This document outlines the steps to manually create and configure the AWS resources for an automated audio transcription and summary workflow using the AWS Management Console, without deploying a CloudFormation template.

## Architecture

The workflow consists of the following AWS services, configured to interact seamlessly:

1.  **Input Audio S3 Bucket (`<your-input-audio-bucket-name>`):** You upload your audio files (e.g., `.mp3`, `.wav`) to this S3 bucket.
2.  **SQS Queue (`sqs-to-lambda`):** An SQS queue receives notifications whenever new audio files are added to the input bucket.
3.  **Data to Transcribe Lambda Function (`sqs-to-transcribe`):** This Lambda function is automatically invoked by messages in the SQS queue. It retrieves the audio file and initiates an AWS Transcribe job.
4.  **Transcribe Output S3 Bucket (`<your-transcribe-output-bucket-name>`):** This bucket stores the text transcription results generated by AWS Transcribe.
5.  **Transcribe to Bedrock Lambda Function (`transcribe-to-bedrock`):** This Lambda function is triggered upon the creation of a new transcription in the output bucket. It retrieves the transcribed text and uses Amazon Bedrock to generate a concise summary.
6.  **Summary Output S3 Bucket (`<your-summary-output-bucket-name>`):** This bucket serves as the destination for the final summaries produced by Amazon Bedrock.

**Remember to replace the bracketed placeholder names (e.g., `<your-input-audio-bucket-name>`) with the actual names you choose during the setup process.**

## Manual Setup Steps (AWS Console)

1.  **Create S3 Buckets:**
    * Create three S3 buckets: one for input audio, one for transcribe output, and one for summary output. Choose unique, descriptive names and the desired AWS Region.

2.  **Create SQS Queue:**
    * Create a standard SQS queue named `sqs-to-lambda`.
    * Set the **Message retention period** to 345600 seconds (4 days).
    * Set the **Visibility timeout** to 120 seconds.
    * Note the **Queue URL** and **ARN**.

3.  **Create IAM Roles:**
    * **`DataToTranscribeRole`:** Create an IAM role for the `sqs-to-transcribe` Lambda function, trusting the `lambda.amazonaws.com` service. Attach a custom policy with the following permissions (replace placeholder bucket names):
        ```json
        {
            "Version": "2012-10-17",
            "Statement": [
                {
                    "Effect": "Allow",
                    "Action": [
                        "logs:CreateLogGroup",
                        "logs:CreateLogStream",
                        "logs:PutLogEvents"
                    ],
                    "Resource": "arn:aws:logs:*:*:*"
                },
                {
                    "Effect": "Allow",
                    "Action": "s3:GetObject",
                    "Resource": "arn:aws:s3:::<your-input-audio-bucket-name>/*"
                },
                {
                    "Effect": "Allow",
                    "Action": "transcribe:StartTranscriptionJob",
                    "Resource": "*"
                },
                {
                    "Effect": "Allow",
                    "Action": "s3:PutObject",
                    "Resource": "arn:aws:s3:::<your-transcribe-output-bucket-name>/*"
                },
                {
                    "Effect": "Allow",
                    "Action": "sqs:*",
                    "Resource": "*"
                }
            ]
        }
        ```
    * Note the **ARN** of this role.

    * **`TranscribeToBedrockRole`:** Create an IAM role for the `transcribe-to-bedrock` Lambda function, trusting the `lambda.amazonaws.com` service. Attach a custom policy with the following permissions (replace placeholder bucket names):
        ```json
        {
            "Version": "2012-10-17",
            "Statement": [
                {
                    "Effect": "Allow",
                    "Action": [
                        "logs:CreateLogGroup",
                        "logs:CreateLogStream",
                        "logs:PutLogEvents"
                    ],
                    "Resource": "arn:aws:logs:*:*:*"
                },
                {
                    "Effect": "Allow",
                    "Action": "s3:*",
                    "Resource": "arn:aws:s3:::<your-transcribe-output-bucket-name>/*"
                },
                {
                    "Effect": "Allow",
                    "Action": "bedrock:InvokeModel",
                    "Resource": "*"
                },
                {
                    "Effect": "Allow",
                    "Action": "s3:*",
                    "Resource": "arn:aws:s3:::<your-summary-output-bucket-name>/*"
                }
            ]
        }
        ```
    * Note the **ARN** of this role.

4.  **Create Lambda Functions:**
    * **`sqs-to-transcribe`:**
        * Create a new Lambda function.
        * Set the runtime to `Python 3.9`.
        * Assign the `DataToTranscribeRole` to this function.
        * Upload your `transcribe.zip` code package.
        * Set the handler to `lambda_function.lambda_handler`.
        * Set the memory to 128 MB and the timeout to 60 seconds.

    * **`transcribe-to-bedrock`:**
        * Create a new Lambda function.
        * Set the runtime to `Python 3.9`.
        * Assign the `TranscribeToBedrockRole` to this function.
        * Upload your `summarize.zip` code package.
        * Set the handler to `lambda_function.lambda_handler`.
        * Set the memory to 128 MB and the timeout to 300 seconds.

5.  **Configure S3 Event Notification (Input Bucket to SQS):**
    * In your input audio S3 bucket, create an event notification.
    * Configure it to send notifications for "All object create events" to the SQS queue you created (`sqs-to-lambda`) using its ARN.

6.  **Configure S3 Event Notification (Transcribe Output Bucket to Lambda):**
    * In your transcribe output S3 bucket, create an event notification.
    * Configure it to send notifications for "All object create events" to the `transcribe-to-bedrock` Lambda function using its ARN. Grant S3 permission to invoke the Lambda function if prompted.

7.  **Configure SQS Trigger for `sqs-to-transcribe` Lambda:**
    * In the Lambda console, add an SQS trigger to the `sqs-to-transcribe` function, selecting the `sqs-to-lambda` queue.

8.  **Configure SQS Queue Policy:**
    * In the SQS console, edit the access policy for the `sqs-to-lambda` queue. Add a policy statement to allow the input audio S3 bucket (using its ARN) to send messages to the queue. It's recommended to use a condition to restrict access to this specific bucket.

9.  **Verify Lambda Permissions (S3 Triggers):**
    * Ensure that the `transcribe-to-bedrock` Lambda function has the necessary permissions to be invoked by the transcribe output S3 bucket. This is usually handled during the event notification setup. If not, manually add a permission in the Lambda console.

## Using the Workflow (Console Interaction)

1.  Upload your audio files to the input audio S3 bucket.
2.  Monitor the SQS queue and Lambda function logs in CloudWatch for progress or errors.
3.  Retrieve the generated summary files from the summary output S3 bucket.

## Important Considerations (Manual Console Setup)

* Ensure all S3 bucket names are globally unique.
* Double-check all ARNs and resource names during configuration.
* Manually managing these resources can be more error-prone and time-consuming than using Infrastructure as Code.
* The specific logic for transcription and summarization is within the Lambda function code (`transcribe.zip` and `summarize.zip`).
* Ensure the IAM roles have the necessary permissions for all involved services, including the specific Bedrock model you intend to use.
* Monitor your AWS costs for the S3, SQS, Transcribe, Lambda, and Bedrock services.
